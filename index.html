<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ec4899">
    <meta name="description" content="GK Store - Exclusive Video Marketplace">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GK Store">
    
    <title>GK Store - Video Marketplace</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJvSURBVHgB7d2/axNRHAfw7727NFqtFoRCwIogCA50dHDQhS4qdBH6H5QiiBM6OEgHB4cODoqDgo4iCA4ODiL0HxAqhUIrSqFQ6h9pzfe8npWE3L33fvf7fb/vQy8pOe/OO+/dzU1OoJiiPR7Yb27CPw5YL0E0Uh7P2UtUnwTsH71Cbvq/7HJ4EtWn06dePdWH2uadJOdBPb8Ip6d7m5NPc8Lor/i1nRbM/mbNdCx7NNZQYOy9O5DNMMAldy8Y3XUQYnelcgTWmXWYBjjUuWEYijGlUrEKwOBoEoDeI8kCTL//tQlA75hUARj/v3L/+AaxSRdgf3kx3VEvwKDA5enUcSiulQJm+hdNHyVGLB4+/6GALKIYwShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgFKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowShACUYBSjAKUIJRgBKMApRgFKAEowAlGAUowSlCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBKMAJRgFKMEoQAlGAUowClCCUYASjAKUYBSgBJLA/wDplQqfXop5vAAAAABJRU5ErkJggg==">
    
    <!-- Supabase Client (will only work online) -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.39.7/dist/umd/supabase.js"></script>
    
    <!-- Font Awesome (embedded as inline SVG and CSS for offline) -->
    <style>
        /* Font Awesome 6 Free inline icons - essential icons only */
        .fas, .far, .fab {
            font-family: 'Font Awesome 6 Free', 'Font Awesome 6 Brands';
            font-weight: 900;
            -webkit-font-smoothing: antialiased;
            display: inline-block;
            font-style: normal;
            font-variant: normal;
            text-rendering: auto;
            line-height: 1;
        }
        
        .fa-home:before { content: "\f015"; }
        .fa-user:before { content: "\f007"; }
        .fa-user-shield:before { content: "\f505"; }
        .fa-shopping-bag:before { content: "\f290"; }
        .fa-headset:before { content: "\f590"; }
        .fa-globe:before { content: "\f0ac"; }
        .fa-moon:before { content: "\f186"; }
        .fa-sign-in-alt:before { content: "\f2f6"; }
        .fa-sign-out-alt:before { content: "\f2f5"; }
        .fa-user-plus:before { content: "\f234"; }
        .fa-lock:before { content: "\f023"; }
        .fa-play-circle:before { content: "\f144"; }
        .fa-eye:before { content: "\f06e"; }
        .fa-heart:before { content: "\f004"; }
        .fa-share:before { content: "\f064"; }
        .fa-bookmark:before { content: "\f02e"; }
        .fa-crown:before { content: "\f521"; }
        .fa-user-tie:before { content: "\f508"; }
        .fa-whatsapp:before { content: "\f232"; font-family: 'Font Awesome 6 Brands'; }
        .fa-telegram:before { content: "\f2c6"; font-family: 'Font Awesome 6 Brands'; }
        .fa-wallet:before { content: "\f555"; }
        .fa-copy:before { content: "\f0c5"; }
        .fa-check:before { content: "\f00c"; }
        .fa-times:before { content: "\f00d"; }
        .fa-upload:before { content: "\f093"; }
        .fa-download:before { content: "\f019"; }
        .fa-cloud-upload-alt:before { content: "\f382"; }
        .fa-video:before { content: "\f03d"; }
        .fa-inbox:before { content: "\f01c"; }
        .fa-bell:before { content: "\f0f3"; }
        .fa-arrow-right:before { content: "\f061"; }
        .fa-arrow-left:before { content: "\f060"; }
        .fa-chevron-up:before { content: "\f077"; }
        .fa-chevron-down:before { content: "\f078"; }
        .fa-spinner:before { content: "\f110"; }
        .fa-check-circle:before { content: "\f058"; }
        .fa-exclamation-circle:before { content: "\f06a"; }
        .fa-info-circle:before { content: "\f05a"; }
        .fa-exclamation-triangle:before { content: "\f071"; }
        .fa-wifi-slash:before { content: "\f6ab"; }
        .fa-trash:before { content: "\f1f8"; }
        .fa-edit:before { content: "\f044"; }
        .fa-link:before { content: "\f0c1"; }
        .fa-share-alt:before { content: "\f1e0"; }
        .fa-play:before { content: "\f04b"; }
        .fa-pause:before { content: "\f04c"; }
        .fa-volume-up:before { content: "\f028"; }
        .fa-volume-mute:before { content: "\f6a9"; }
        .fa-expand:before { content: "\f065"; }
        .fa-compress:before { content: "\f066"; }
        
        /* Rest of your CSS styles */
        :root {
            --primary: #ec4899;
            --primary-dark: #db2777;
            --secondary: #8b5cf6;
            --secondary-dark: #7c3aed;
            --accent: #f59e0b;
            --background: #000000;
            --surface: #18181b;
            --surface-light: #27272a;
            --text: #ffffff;
            --text-secondary: #a1a1aa;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #3f3f46;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html { font-size: 16px; scroll-behavior: smooth; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--surface); }
        ::-webkit-scrollbar-thumb { background: var(--surface-light); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--border); }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        .animate-spin { animation: spin 1s linear infinite; }
        .shimmer {
            background: linear-gradient(90deg, var(--surface-light) 0%, var(--surface) 50%, var(--surface-light) 100%);
            background-size: 200% auto;
            animation: shimmer 2s infinite linear;
        }

        /* Utility */
        .gradient-text { background: var(--gradient); -webkit-background-clip: text; background-clip: text; color: transparent; }
        .gradient-bg { background: var(--gradient); }
        .glass-effect { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .blur-bg { backdrop-filter: blur(20px); background: rgba(0,0,0,0.5); }
        .hidden { display: none !important; }

        /* Layout */
        .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        .page { min-height: 100vh; position: relative; overflow-x: hidden; }
        .content { padding: 5rem 1rem 7rem; }

        /* Navigation */
        .top-nav {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 1rem;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border);
        }
        .nav-content { display: flex; align-items: center; justify-content: space-between; }
        .logo { display: flex; align-items: center; gap: 0.75rem; font-weight: 700; text-decoration: none; color: var(--text); }
        .logo-icon { width: 2rem; height: 2rem; background: var(--gradient); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; }
        .nav-actions { display: flex; align-items: center; gap: 0.5rem; }
        
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; padding: 0.75rem 1rem;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); border-top: 1px solid var(--border);
        }
        .nav-items { display: flex; justify-content: space-around; align-items: center; max-width: 400px; margin: 0 auto; }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--text-secondary);
            padding: 0.5rem; border-radius: 0.75rem; min-width: 4rem; transition: all 0.2s;
        }
        .nav-item:hover { color: var(--text); background: rgba(255,255,255,0.05); }
        .nav-item.active { color: var(--primary); background: rgba(236,72,153,0.1); }
        .nav-item i { font-size: 1.25rem; margin-bottom: 0.25rem; }
        .nav-item span { font-size: 0.75rem; font-weight: 500; }

        /* Buttons */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; font-weight: 600; font-size: 0.875rem; cursor: pointer; border: none;
            transition: all 0.2s ease; position: relative; overflow: hidden;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        .btn:active { transform: translateY(0); }
        .btn-primary { background: var(--gradient); color: white; }
        .btn-secondary { background: var(--surface-light); color: var(--text); border: 1px solid var(--border); }
        .btn-outline { background: transparent; color: var(--text); border: 1px solid var(--border); }
        .btn-icon { width: 2.5rem; height: 2.5rem; padding: 0; border-radius: 50%; }
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.75rem; }

        /* Cards */
        .card { background: var(--surface); border-radius: 1rem; border: 1px solid var(--border); overflow: hidden; transition: all 0.3s; }
        .card:hover { border-color: var(--primary); transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .card-glass { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .card-header { padding: 1.5rem; border-bottom: 1px solid var(--border); }
        .card-body { padding: 1.5rem; }
        .card-footer { padding: 1.5rem; border-top: 1px solid var(--border); }

        /* Forms */
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-secondary); }
        .input {
            width: 100%; padding: 0.75rem 1rem; background: var(--surface-light); border: 1px solid var(--border);
            border-radius: 0.75rem; color: var(--text); font-size: 0.875rem; transition: all 0.2s;
        }
        .input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(236,72,153,0.1); }
        .textarea { min-height: 120px; resize: vertical; }

        /* Video Player */
        .video-container {
            position: relative; width: 100%; height: calc(100vh - 140px); overflow: hidden; background: #000;
        }
        .video-player { width: 100%; height: 100%; object-fit: contain; background: #000; display: block; }
        
        @media (max-width: 768px) {
            .video-container { height: calc(100vh - 120px); }
            .video-player { object-fit: contain; width: 100%; max-height: 100%; }
        }

        .video-overlay {
            position: absolute; inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 20%, transparent 80%, rgba(0,0,0,0.9) 100%);
            display: flex; flex-direction: column; justify-content: space-between; padding: 2rem; pointer-events: none;
        }
        .video-overlay * { pointer-events: auto; }
        .video-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .video-description { color: rgba(255,255,255,0.9); margin-bottom: 1rem; line-height: 1.6; }
        .video-stats { display: flex; gap: 1rem; color: rgba(255,255,255,0.8); font-size: 0.875rem; }

        .video-top-actions {
            position: absolute; right: 1rem; top: 30%; display: flex; flex-direction: column; gap: 1.5rem; z-index: 100;
        }
        .video-right-actions {
            position: absolute; right: 1rem; bottom: 6rem; display: flex; flex-direction: column; gap: 1.5rem; z-index: 100;
        }
        .action-button {
            width: 3rem; height: 3rem; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px); color: white;
            border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;
            transition: all 0.2s; border: 1px solid rgba(255,255,255,0.1);
        }
        .action-button:hover { background: rgba(236,72,153,0.5); transform: scale(1.1); }
        .action-label { font-size: 0.75rem; text-align: center; margin-top: 0.25rem; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }

        /* Grid */
        .grid { display: grid; gap: 1.5rem; }
        .grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        @media (min-width: 768px) { .md\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); } }
        @media (min-width: 1024px) { .lg\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); } }

        /* Video Item */
        .video-item { position: relative; border-radius: 1rem; overflow: hidden; cursor: pointer; aspect-ratio: 9/16; }
        .video-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .video-item:hover img { transform: scale(1.05); }
        .video-item-overlay {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); padding: 1rem; color: white;
        }
        .video-item-title { font-weight: 600; margin-bottom: 0.25rem; font-size: 0.875rem; }
        .video-item-stats { display: flex; gap: 0.75rem; font-size: 0.75rem; color: rgba(255,255,255,0.8); }

        .video-grid-share-btn {
            position: absolute; top: 0.5rem; right: 0.5rem; width: 2.5rem; height: 2.5rem;
            background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); color: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s;
            border: 1px solid rgba(255,255,255,0.2); z-index: 10;
        }
        .video-grid-share-btn:hover { background: rgba(236,72,153,0.7); transform: scale(1.1); }

        /* Account Card */
        .account-card {
            padding: 1.5rem; border-radius: 1rem; background: var(--surface); border: 1px solid var(--border);
            transition: all 0.3s; height: 100%;
        }
        .account-card:hover { border-color: var(--primary); transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .account-icon {
            width: 60px; height: 60px; border-radius: 12px; display: flex; align-items: center;
            justify-content: center; font-size: 1.5rem; margin-bottom: 1rem;
            cursor: pointer;
        }
        .account-icon.small { background: linear-gradient(135deg, #10b981, #059669); }
        .account-icon.medium { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .account-icon.big { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }

        /* Account Action Buttons */
        .account-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .account-action-btn {
            flex: 1;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        .account-action-btn.book { background: rgba(236,72,153,0.1); color: var(--primary); border: 1px solid rgba(236,72,153,0.2); }
        .account-action-btn.buy { background: rgba(16,185,129,0.1); color: var(--success); border: 1px solid rgba(16,185,129,0.2); }
        .account-action-btn.share { background: rgba(139,92,246,0.1); color: var(--secondary); border: 1px solid rgba(139,92,246,0.2); }
        .account-action-btn.play { background: rgba(245,158,11,0.1); color: var(--warning); border: 1px solid rgba(245,158,11,0.2); }
        .account-action-btn:hover { transform: translateY(-2px); filter: brightness(1.1); }

        /* Upload Progress */
        .upload-status {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--surface-light);
            border-radius: 0.75rem;
        }
        .progress-bar {
            width: 100%;
            height: 0.5rem;
            background: var(--border);
            border-radius: 9999px;
            overflow: hidden;
            margin: 0.5rem 0;
        }
        .progress-fill {
            height: 100%;
            background: var(--gradient);
            border-radius: 9999px;
            transition: width 0.3s;
        }

        /* Modals */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 2000;
            display: flex; align-items: center; justify-content: center; padding: 1rem;
        }
        .modal {
            background: var(--surface); border-radius: 1.5rem; border: 1px solid var(--border);
            width: 100%; max-width: 400px; max-height: 90vh; overflow-y: auto;
        }
        .modal-header { padding: 1.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        .modal-title { font-size: 1.25rem; font-weight: 700; }
        .modal-close { background: none; border: none; color: var(--text-secondary); cursor: pointer; width: 2.5rem; height: 2.5rem; border-radius: 0.5rem; transition: all 0.2s; }
        .modal-close:hover { background: rgba(255,255,255,0.05); color: var(--text); }
        .modal-body { padding: 1.5rem; }
        .modal-footer { padding: 1.5rem; border-top: 1px solid var(--border); display: flex; gap: 1rem; }

        /* File Upload */
        .file-upload-area {
            border: 2px dashed var(--border); border-radius: 1rem; padding: 2rem; text-align: center;
            cursor: pointer; transition: all 0.3s; background: var(--surface-light);
        }
        .file-upload-area:hover { border-color: var(--primary); background: rgba(236,72,153,0.05); }
        .file-upload-area.dragover { border-color: var(--primary); background: rgba(236,72,153,0.1); }
        .file-upload-area.has-file {
            border-color: var(--success);
            background: rgba(16,185,129,0.05);
        }

        /* Badges */
        .badge {
            display: inline-flex; align-items: center; padding: 0.25rem 0.75rem; border-radius: 9999px;
            font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.025em;
        }
        .badge-primary { background: rgba(236,72,153,0.1); color: var(--primary); border: 1px solid rgba(236,72,153,0.2); }
        .badge-secondary { background: rgba(139,92,246,0.1); color: var(--secondary); border: 1px solid rgba(139,92,246,0.2); }
        .badge-success { background: rgba(16,185,129,0.1); color: var(--success); border: 1px solid rgba(16,185,129,0.2); }
        .badge-warning { background: rgba(245,158,11,0.1); color: var(--warning); border: 1px solid rgba(245,158,11,0.2); }
        .badge-danger { background: rgba(239,68,68,0.1); color: var(--danger); border: 1px solid rgba(239,68,68,0.2); }

        /* Notifications */
        .notification-bell {
            position: fixed; left: 1rem; bottom: 5rem; width: 3rem; height: 3rem; border-radius: 50%;
            background: var(--surface-light); color: var(--text); display: flex; align-items: center;
            justify-content: center; cursor: pointer; z-index: 100; transition: all 0.3s;
            border: 1px solid var(--border);
        }
        .notification-bell:hover { background: var(--surface); transform: scale(1.1); }
        .notification-badge {
            position: absolute; top: -0.25rem; right: -0.25rem; width: 1.25rem; height: 1.25rem;
            background: var(--danger); color: white; border-radius: 50%; font-size: 0.75rem;
            display: flex; align-items: center; justify-content: center; font-weight: 600;
        }

        /* PWA Install Button */
        .pwa-install-btn {
            position: fixed; left: 1rem; bottom: 9rem; width: 3rem; height: 3rem; border-radius: 50%;
            background: var(--primary); color: white; display: flex; align-items: center; justify-content: center;
            cursor: pointer; z-index: 100; box-shadow: 0 10px 25px rgba(236,72,153,0.3); transition: all 0.3s;
            border: none;
        }

        /* Offline Indicator */
        .offline-indicator {
            position: fixed; top: 0; left: 0; right: 0; background: var(--danger); color: white;
            text-align: center; padding: 0.5rem; font-size: 0.875rem; z-index: 2000; display: none;
        }
        .offline-indicator.show { display: block; animation: slideIn 0.3s; }

        /* Auth */
        .auth-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        .auth-card { width: 100%; max-width: 400px; padding: 2rem; }
        .auth-divider { display: flex; align-items: center; margin: 1.5rem 0; }
        .auth-divider::before, .auth-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
        .auth-divider span { padding: 0 1rem; color: var(--text-secondary); font-size: 0.875rem; }

        /* Toast */
        #toast {
            position: fixed; top: 4rem; right: 1rem; z-index: 2000; max-width: 350px;
        }

        /* Tab Bar */
        .tab-bar { display: flex; background: var(--surface); border-radius: 1rem; padding: 0.25rem; margin-bottom: 1.5rem; }
        .tab-item {
            flex: 1; padding: 0.75rem 1rem; text-align: center; font-weight: 500; cursor: pointer;
            border-radius: 0.75rem; transition: all 0.2s;
        }
        .tab-item:hover { background: rgba(255,255,255,0.05); }
        .tab-item.active { background: var(--gradient); color: white; }

        /* Gradient Effects */
        .gradient-bg-effects { position: fixed; inset: 0; z-index: -1; overflow: hidden; }
        .gradient-circle { position: absolute; border-radius: 50%; filter: blur(100px); opacity: 0.2; }
        .gradient-1 { top: -10%; right: -10%; width: 40%; height: 40%; background: var(--primary); }
        .gradient-2 { bottom: -10%; left: -10%; width: 40%; height: 40%; background: var(--secondary); }
        .gradient-3 { top: 50%; left: 50%; transform: translate(-50%, -50%); width: 30%; height: 30%; background: var(--accent); }

        /* Responsive */
        @media (max-width: 640px) {
            html { font-size: 14px; }
            .nav-item span { display: none; }
            .nav-item { min-width: 3rem; }
        }
    </style>
    
    <!-- Inline Service Worker Registration -->
    <script>
        // Register service worker for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Create service worker as a Blob and register it
                const swCode = `
                    const CACHE_NAME = 'gk-store-v1';
                    const urlsToCache = [
                        '/',
                        'index.html'
                    ];

                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => {
                                    console.log('Opened cache');
                                    return cache.addAll(urlsToCache);
                                })
                        );
                    });

                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => {
                                    if (response) {
                                        return response;
                                    }
                                    return fetch(event.request)
                                        .then(response => {
                                            if (!response || response.status !== 200 || response.type !== 'basic') {
                                                return response;
                                            }
                                            const responseToCache = response.clone();
                                            caches.open(CACHE_NAME)
                                                .then(cache => {
                                                    if (!event.request.url.match(/\\.(mp4|webm|ogg)$/i)) {
                                                        cache.put(event.request, responseToCache);
                                                    }
                                                });
                                            return response;
                                        });
                                })
                        );
                    });

                    self.addEventListener('activate', event => {
                        const cacheWhitelist = [CACHE_NAME];
                        event.waitUntil(
                            caches.keys().then(cacheNames => {
                                return Promise.all(
                                    cacheNames.map(cacheName => {
                                        if (cacheWhitelist.indexOf(cacheName) === -1) {
                                            return caches.delete(cacheName);
                                        }
                                    })
                                );
                            })
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const url = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(url)
                    .then(registration => console.log('ServiceWorker registered'))
                    .catch(err => console.log('ServiceWorker registration failed: ', err));
            });
        }
    </script>
</head>
<body>
    <!-- Offline Indicator -->
    <div id="offline-indicator" class="offline-indicator">
        <i class="fas fa-wifi-slash"></i> You are currently offline. Some features may be limited.
    </div>

    <!-- PWA Install Button -->
    <button id="pwa-install-btn" class="pwa-install-btn hidden">
        <i class="fas fa-download"></i>
    </button>

    <!-- Gradient Background -->
    <div class="gradient-bg-effects">
        <div class="gradient-circle gradient-1"></div>
        <div class="gradient-circle gradient-2"></div>
        <div class="gradient-circle gradient-3"></div>
    </div>

    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-content">
            <a href="#home" class="logo" onclick="showPage('home')">
                <div class="logo-icon">
                    <span style="font-size: 1rem; color: white;">GK</span>
                </div>
                <span class="gradient-text">GK Store</span>
            </a>
            
            <div class="nav-actions">
                <button class="btn btn-icon btn-secondary" onclick="toggleLanguage()">
                    <i class="fas fa-globe"></i>
                </button>
                <button class="btn btn-icon btn-secondary" onclick="showPage('admin')">
                    <i class="fas fa-user-shield"></i>
                </button>
                <button class="btn btn-icon btn-secondary" onclick="toggleTheme()">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div id="content-container" class="content">
        <!-- Auth Page -->
        <div id="auth-page" class="page">
            <div class="auth-container">
                <div class="auth-card card">
                    <!-- Login -->
                    <div id="login-form-container">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 gradient-bg rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <span style="color: white; font-size: 1.5rem;">GK</span>
                            </div>
                            <h2 class="text-2xl font-bold mb-2">Welcome to GK Store</h2>
                            <p class="text-zinc-400">Sign in to access premium content</p>
                        </div>
                        
                        <form id="login-form" onsubmit="login(event)">
                            <div class="input-group">
                                <label class="input-label">Email</label>
                                <input type="email" class="input" id="login-email" required>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Password</label>
                                <input type="password" class="input" id="login-password" required>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <label class="flex items-center">
                                    <input type="checkbox" id="remember-me" class="mr-2">
                                    <span class="text-sm">Remember me</span>
                                </label>
                                <a href="#" class="text-sm text-primary" onclick="showForgotPassword()">Forgot password?</a>
                            </div>
                            <button type="submit" class="btn btn-primary w-full mb-4">
                                <i class="fas fa-sign-in-alt"></i> Sign In
                            </button>
                        </form>
                        
                        <div class="auth-divider"><span>Or</span></div>
                        
                        <div class="auth-switch text-center">
                            <span>Don't have an account? </span>
                            <a href="#" class="text-primary" onclick="showSignupForm()">Sign up</a>
                        </div>
                    </div>
                    
                    <!-- Signup -->
                    <div id="signup-form-container" class="hidden">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 gradient-bg rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <span style="color: white; font-size: 1.5rem;">GK</span>
                            </div>
                            <h2 class="text-2xl font-bold mb-2">Create Account</h2>
                        </div>
                        
                        <form id="signup-form" onsubmit="signup(event)">
                            <div class="input-group">
                                <label class="input-label">Full Name</label>
                                <input type="text" class="input" id="signup-name" required>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Email</label>
                                <input type="email" class="input" id="signup-email" required>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Password</label>
                                <input type="password" class="input" id="signup-password" required>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Confirm Password</label>
                                <input type="password" class="input" id="signup-confirm-password" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-full">
                                <i class="fas fa-user-plus"></i> Create Account
                            </button>
                        </form>
                        
                        <div class="auth-switch text-center mt-4">
                            <span>Already have an account? </span>
                            <a href="#" class="text-primary" onclick="showLoginForm()">Sign in</a>
                        </div>
                    </div>
                    
                    <!-- Forgot Password -->
                    <div id="forgot-password-container" class="hidden">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 gradient-bg rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-lock text-white text-2xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold mb-2">Reset Password</h2>
                        </div>
                        
                        <form id="forgot-password-form" onsubmit="resetPassword(event)">
                            <div class="input-group">
                                <label class="input-label">Email</label>
                                <input type="email" class="input" id="reset-email" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-full">
                                Send Reset Link
                            </button>
                        </form>
                        
                        <div class="auth-switch text-center mt-4">
                            <a href="#" onclick="showLoginForm()">‚Üê Back to login</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="page animate-fade-in hidden">
            <div id="video-section" class="video-container">
                <div id="video-placeholder" class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="w-16 h-16 border-4 border-transparent border-t-pink-500 rounded-full animate-spin mx-auto mb-4"></div>
                        <p class="text-zinc-400">Loading premium content...</p>
                    </div>
                </div>
            </div>
            
            <div id="video-grid" class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-6"></div>
            <div id="loading-more" class="hidden text-center py-8">
                <div class="w-8 h-8 border-2 border-transparent border-t-pink-500 rounded-full animate-spin mx-auto"></div>
                <p class="text-zinc-400 mt-2">Loading more videos...</p>
            </div>
        </div>

        <!-- Accounts Page -->
        <div id="accounts-page" class="page hidden">
            <h2 class="text-2xl font-bold mb-6">Premium Accounts</h2>
            
            <div class="tab-bar mb-6">
                <div class="tab-item active" onclick="filterAccounts('all')">All</div>
                <div class="tab-item" onclick="filterAccounts('small')">Small</div>
                <div class="tab-item" onclick="filterAccounts('medium')">Medium</div>
                <div class="tab-item" onclick="filterAccounts('big')">Big</div>
            </div>
            
            <div id="accounts-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="page hidden">
            <div class="flex flex-col items-center mb-8">
                <div class="w-24 h-24 rounded-full gradient-bg flex items-center justify-center text-2xl font-bold mb-4">
                    <span>GK</span>
                </div>
                <h2 class="text-2xl font-bold">User Profile</h2>
                <p class="text-zinc-400">Premium Member</p>
            </div>
            
            <div class="grid gap-4">
                <div class="card">
                    <div class="card-body">
                        <h3 class="font-semibold mb-4">Account Information</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-zinc-400">Name</span>
                                <span id="user-name">John Doe</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-zinc-400">Email</span>
                                <span id="user-email">john@example.com</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-zinc-400">Member Since</span>
                                <span id="member-since">Jan 2024</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <h3 class="font-semibold mb-4">Statistics</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center p-4 bg-surface-light rounded-lg">
                                <div class="text-2xl font-bold gradient-text" id="videos-watched-count">0</div>
                                <div class="text-sm text-zinc-400">Videos Watched</div>
                            </div>
                            <div class="text-center p-4 bg-surface-light rounded-lg">
                                <div class="text-2xl font-bold gradient-text" id="accounts-booked-count">0</div>
                                <div class="text-sm text-zinc-400">Accounts Booked</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-secondary w-full" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <!-- Contact Page -->
        <div id="contact-page" class="page hidden">
            <h2 class="text-2xl font-bold mb-6">Contact Us</h2>
            
            <div class="grid gap-6">
                <div class="card">
                    <div class="card-body">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 rounded-full gradient-bg flex items-center justify-center">
                                <i class="fas fa-whatsapp text-white"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold">WhatsApp Support</h3>
                                <p class="text-zinc-400">+93 793066322</p>
                            </div>
                        </div>
                        <button class="btn btn-primary w-full" onclick="openWhatsApp()">
                            <i class="fab fa-whatsapp"></i> Chat Now
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 rounded-full bg-amber-500 flex items-center justify-center">
                                <i class="fas fa-wallet text-white"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold">USDT Address (TRC20)</h3>
                                <p class="text-zinc-400 text-sm">Send payment to this address</p>
                            </div>
                        </div>
                        <div class="bg-surface-light p-3 rounded-lg mb-4">
                            <code id="usdt-address" class="text-sm break-all">TYpeauzqbVusejMAhJPnXuSb7wY6p69ZoY</code>
                        </div>
                        <button class="btn btn-secondary w-full" onclick="copyUSDTAddress()">
                            <i class="far fa-copy"></i> Copy Address
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Page -->
        <div id="admin-page" class="page hidden">
            <h2 class="text-2xl font-bold mb-6">Admin Panel</h2>
            
            <div class="grid gap-6">
                <div class="card">
                    <div class="card-body">
                        <h3 class="font-semibold mb-4">Admin Login</h3>
                        <form id="admin-login-form" onsubmit="adminLogin(event)">
                            <div class="input-group">
                                <label class="input-label">Admin Email</label>
                                <input type="email" id="admin-email" class="input" required>
                            </div>
                            <div class="input-group">
                                <label class="input-label">Admin Password</label>
                                <input type="password" id="admin-password" class="input" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-full">
                                <i class="fas fa-lock"></i> Login as Admin
                            </button>
                        </form>
                    </div>
                </div>
                
                <div id="admin-dashboard" class="hidden">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="card"><div class="card-body text-center"><div class="text-2xl font-bold gradient-text" id="admin-video-count">0</div><div class="text-sm text-zinc-400">Total Videos</div></div></div>
                        <div class="card"><div class="card-body text-center"><div class="text-2xl font-bold gradient-text" id="admin-registered-users">0</div><div class="text-sm text-zinc-400">Registered Users</div></div></div>
                        <div class="card"><div class="card-body text-center"><div class="text-2xl font-bold gradient-text" id="admin-online-users">1</div><div class="text-sm text-zinc-400">Online Users</div></div></div>
                        <div class="card"><div class="card-body text-center"><div class="text-2xl font-bold gradient-text" id="admin-sold-count">0</div><div class="text-sm text-zinc-400">Sold Accounts</div></div></div>
                    </div>
                    
                    <div class="card mb-6">
                        <div class="card-body">
                            <h3 class="font-semibold mb-4">Quick Actions</h3>
                            <div class="grid grid-cols-1 gap-3">
                                <button class="btn btn-secondary" onclick="showUploadVideo()"><i class="fas fa-upload"></i> Upload Video</button>
                                <button class="btn btn-secondary" onclick="showManageVideos()"><i class="fas fa-video"></i> Manage Videos</button>
                                <button class="btn btn-secondary" onclick="showBookRequests()"><i class="fas fa-bookmark"></i> Book Requests</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-body">
                            <h3 class="font-semibold mb-4">Recent Activity</h3>
                            <div id="admin-recent-activity" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notifications Page -->
        <div id="notifications-page" class="page hidden">
            <h2 class="text-2xl font-bold mb-6">Notifications</h2>
            <div id="notifications-list" class="space-y-3"></div>
            <div id="notifications-empty" class="hidden text-center py-12">
                <i class="far fa-bell text-4xl text-zinc-600 mb-4"></i>
                <h3 class="text-xl font-semibold mb-2">No Notifications</h3>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-items">
            <a href="#accounts" class="nav-item" onclick="showPage('accounts')">
                <i class="fas fa-shopping-bag"></i>
                <span>Accounts</span>
            </a>
            <a href="#home" class="nav-item active" onclick="showPage('home')">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="#profile" class="nav-item" onclick="showPage('profile')">
                <i class="far fa-user"></i>
                <span>Profile</span>
            </a>
            <a href="#contact" class="nav-item" onclick="showPage('contact')">
                <i class="fas fa-headset"></i>
                <span>Contact</span>
            </a>
        </div>
    </nav>

    <!-- Notification Bell -->
    <div class="notification-bell" onclick="showPage('notifications')">
        <i class="far fa-bell"></i>
        <div id="notification-count" class="notification-badge hidden">0</div>
    </div>

    <!-- Modals -->
    <div id="book-modal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Book Account</h3>
                <button class="modal-close" onclick="closeModal('book-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="card glass-effect p-4 mb-4">
                    <h4 id="book-account-name" class="font-semibold mb-1"></h4>
                    <p id="book-account-tier" class="badge badge-secondary text-xs"></p>
                    <p id="book-account-price" class="text-lg font-bold mt-2"></p>
                </div>
                <form id="book-form">
                    <div class="input-group">
                        <label class="input-label">Your Name</label>
                        <input type="text" class="input" id="book-name" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">WhatsApp Number</label>
                        <input type="tel" class="input" id="book-whatsapp" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary flex-1" onclick="closeModal('book-modal')">Cancel</button>
                <button class="btn btn-primary flex-1" onclick="submitBookRequest()">Submit</button>
            </div>
        </div>
    </div>

    <div id="buy-modal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Buy with USDT</h3>
                <button class="modal-close" onclick="closeModal('buy-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="card glass-effect p-4 mb-4">
                    <h4 id="buy-account-name" class="font-semibold mb-1"></h4>
                    <p id="buy-account-tier" class="badge badge-secondary text-xs"></p>
                    <p id="buy-account-price" class="text-2xl font-bold mt-2"></p>
                </div>
                <div class="bg-surface-light p-4 rounded-lg mb-4">
                    <div class="flex justify-between mb-2">
                        <span class="text-sm text-zinc-400">USDT Address (TRC20)</span>
                        <button class="btn btn-sm btn-secondary" onclick="copyAddress()">Copy</button>
                    </div>
                    <code id="payment-address" class="text-sm break-all">TYpeauzqbVusejMAhJPnXuSb7wY6p69ZoY</code>
                </div>
                <button class="btn btn-primary w-full" onclick="openPaymentChat()">
                    <i class="fab fa-whatsapp"></i> Confirm on WhatsApp
                </button>
            </div>
        </div>
    </div>

    <div id="share-modal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Share Video</h3>
                <button class="modal-close" onclick="closeModal('share-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4 id="share-video-title" class="font-semibold text-center mb-4"></h4>
                <div class="grid grid-cols-4 gap-3 mb-6">
                    <button class="flex flex-col items-center p-3 bg-surface-light rounded-lg" onclick="shareViaWhatsApp()">
                        <i class="fab fa-whatsapp text-green-500 text-2xl mb-2"></i>
                        <span class="text-xs">WhatsApp</span>
                    </button>
                    <button class="flex flex-col items-center p-3 bg-surface-light rounded-lg" onclick="shareViaTelegram()">
                        <i class="fab fa-telegram text-blue-500 text-2xl mb-2"></i>
                        <span class="text-xs">Telegram</span>
                    </button>
                    <button class="flex flex-col items-center p-3 bg-surface-light rounded-lg" onclick="copyShareLink()">
                        <i class="fas fa-link text-purple-500 text-2xl mb-2"></i>
                        <span class="text-xs">Copy</span>
                    </button>
                    <button class="flex flex-col items-center p-3 bg-surface-light rounded-lg" onclick="shareViaSystem()">
                        <i class="fas fa-share-alt text-pink-500 text-2xl mb-2"></i>
                        <span class="text-xs">More</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Video Modal -->
    <div id="upload-video-modal" class="modal-overlay hidden">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Upload Video</h3>
                <button class="modal-close" onclick="closeModal('upload-video-modal'); resetUploadForm()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label">Video Title</label>
                    <input type="text" class="input" id="video-title-input" placeholder="Enter video title" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Description</label>
                    <textarea class="input textarea" id="video-description-input" placeholder="Enter video description"></textarea>
                </div>
                <div class="input-group">
                    <label class="input-label">Price ($)</label>
                    <input type="number" class="input" id="video-price" step="0.01" placeholder="0.00" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Tier</label>
                    <select class="input" id="video-tier" required onchange="updateBucketInfo()">
                        <option value="">Select Tier</option>
                        <option value="small">Small (up to 100MB)</option>
                        <option value="medium">Medium (up to 200MB)</option>
                        <option value="big">Big (up to 500MB)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label class="input-label">Video File</label>
                    <div class="file-upload-area" id="file-upload-area" onclick="document.getElementById('video-file').click()">
                        <i class="fas fa-cloud-upload-alt text-3xl text-primary mb-2"></i>
                        <p id="file-upload-text">Click to select video file</p>
                        <p class="text-xs text-zinc-500 mt-1">MP4, WebM, OGG (max 500MB)</p>
                        <input type="file" id="video-file" accept="video/mp4,video/webm,video/ogg" class="hidden" onchange="handleFileSelect(event)">
                    </div>
                    <div id="file-info" class="hidden mt-2 p-2 bg-surface-light rounded-lg">
                        <p class="text-sm"><span class="font-semibold">Selected:</span> <span id="file-name"></span></p>
                        <p class="text-sm"><span class="font-semibold">Size:</span> <span id="file-size"></span></p>
                    </div>
                </div>
                
                <!-- Upload Progress -->
                <div id="upload-status" class="upload-status hidden">
                    <div class="flex justify-between text-sm mb-1">
                        <span id="upload-status-text">Uploading...</span>
                        <span id="upload-percentage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="upload-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <input type="hidden" id="video-url-input">
                <input type="hidden" id="storage-path-input">
                <input type="hidden" id="bucket-name-input">

                <div class="flex gap-2 mt-4">
                    <button class="btn btn-secondary flex-1" onclick="closeModal('upload-video-modal'); resetUploadForm()">Cancel</button>
                    <button class="btn btn-primary flex-1" id="upload-btn" onclick="uploadVideo()">
                        <i class="fas fa-upload"></i> Upload Video
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="manage-videos-modal" class="modal-overlay hidden">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Manage Videos</h3>
                <button class="modal-close" onclick="closeModal('manage-videos-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="tab-bar mb-4">
                    <div class="tab-item active" onclick="adminFilterVideos('all')">All</div>
                    <div class="tab-item" onclick="adminFilterVideos('small')">Small</div>
                    <div class="tab-item" onclick="adminFilterVideos('medium')">Medium</div>
                    <div class="tab-item" onclick="adminFilterVideos('big')">Big</div>
                </div>
                <div id="admin-videos-list" class="space-y-3 max-h-96 overflow-y-auto"></div>
            </div>
        </div>
    </div>

    <div id="book-requests-modal" class="modal-overlay hidden">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Book Requests</h3>
                <button class="modal-close" onclick="closeModal('book-requests-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="admin-book-requests-list" class="space-y-3 max-h-96 overflow-y-auto"></div>
                <div id="admin-book-requests-empty" class="hidden text-center py-8">
                    <i class="fas fa-inbox text-4xl text-zinc-600 mb-4"></i>
                    <h3>No Requests</h3>
                </div>
            </div>
        </div>
    </div>

    <div id="language-modal" class="modal-overlay hidden">
        <div class="modal" style="max-width: 300px;">
            <div class="modal-header">
                <h3 class="modal-title">Select Language</h3>
                <button class="modal-close" onclick="closeModal('language-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body p-0">
                <button class="w-full p-4 text-left hover:bg-surface-light" onclick="setLanguage('en')">
                    üá∫üá∏ English <i id="lang-en-check" class="fas fa-check text-primary float-right"></i>
                </button>
                <button class="w-full p-4 text-left hover:bg-surface-light" onclick="setLanguage('ps')">
                    üá¶üá´ Ÿæ⁄öÿ™Ÿà <i id="lang-ps-check" class="fas fa-check text-primary float-right hidden"></i>
                </button>
                <button class="w-full p-4 text-left hover:bg-surface-light" onclick="setLanguage('fa')">
                    üáÆüá∑ ŸÅÿßÿ±ÿ≥€å <i id="lang-fa-check" class="fas fa-check text-primary float-right hidden"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="welcome-modal" class="modal-overlay">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-body text-center">
                <div class="w-20 h-20 gradient-bg rounded-2xl flex items-center justify-center mx-auto mb-6">
                    <span style="color: white; font-size: 2rem;">GK</span>
                </div>
                <h2 class="text-2xl font-bold mb-4">Welcome to GK Store!</h2>
                <p class="text-zinc-400 mb-6">Your exclusive gateway to premium video content</p>
                <button class="btn btn-primary w-full" onclick="closeWelcomeModal()">
                    Get Started <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="sql-setup-modal" class="modal-overlay hidden">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Database Setup</h3>
                <button class="modal-close" onclick="closeModal('sql-setup-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p class="mb-4">Run this SQL in Supabase SQL Editor:</p>
                <pre class="bg-black text-green-400 p-3 rounded-lg text-xs overflow-x-auto">
CREATE TABLE videos (
    id SERIAL PRIMARY KEY,
    video_id TEXT UNIQUE NOT NULL,
    video_title TEXT NOT NULL,
    description TEXT,
    views INTEGER DEFAULT 0,
    likes INTEGER DEFAULT 0,
    video_url TEXT NOT NULL,
    account_tier TEXT CHECK (account_tier IN ('small','medium','big')) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    sold BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE book_requests (
    id SERIAL PRIMARY KEY,
    video_id TEXT REFERENCES videos(video_id),
    user_name TEXT NOT NULL,
    whatsapp_number TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);</pre>
                <button class="btn btn-primary w-full mt-4" onclick="closeModal('sql-setup-modal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="hidden">
        <div class="bg-surface border border-border rounded-lg shadow-xl p-4">
            <div class="flex items-start gap-3">
                <i id="toast-icon" class="fas fa-check-circle text-success"></i>
                <div class="flex-1">
                    <h4 id="toast-title" class="font-semibold"></h4>
                    <p id="toast-message" class="text-sm text-zinc-400"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supabase configuration (will only work online)
        const SUPABASE_URL = 'https://ieinqlpnubtwwkldqhab.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImllaW5xbHBudWJ0d3drbGRxaGFiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA1MzA3ODcsImV4cCI6MjA4NjEwNjc4N30.sJsoTu1bHBgconNOPfXZk33Ttuy1ZKC2oW2SonBnQ4o';
        
        // Create Supabase client only if online and supabase is available
        let supabase = null;
        try {
            if (navigator.onLine && window.supabase) {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            }
        } catch (e) {
            console.log('Supabase not available offline');
        }

        const appState = {
            currentPage: 'auth', currentVideoIndex: 0, videos: [], accounts: [], notifications: [],
            bookRequests: [], language: 'en', theme: 'dark', isLoggedIn: false, currentUser: null,
            isAdminLoggedIn: false, userStats: { registeredUsers: 0, onlineUsers: 0 },
            currentUpload: { file: null, progress: 0 }, shareVideo: null,
            currentVideoPlayer: null, isFullscreen: false, currentAccount: null,
            isOnline: navigator.onLine
        };

        let deferredPrompt = null;

        async function initApp() {
            loadPreferences();
            setupEventListeners();
            setupPWAInstall();
            
            // Load cached data first for offline
            loadCachedData();
            
            // Check online status
            updateOnlineStatus();
            
            // Try to connect to Supabase if online
            if (navigator.onLine && supabase) {
                await checkDatabaseSetup();
                await loadInitialData();
            }
            
            const savedUser = localStorage.getItem('gkStoreUser');
            if (savedUser) {
                appState.currentUser = JSON.parse(savedUser);
                appState.isLoggedIn = true;
                const adminSession = localStorage.getItem('gkStoreAdmin');
                if (adminSession === 'true') {
                    appState.isAdminLoggedIn = true;
                }
                showPage('home');
            } else showPage('auth');
        }

        function updateOnlineStatus() {
            appState.isOnline = navigator.onLine;
            const indicator = document.getElementById('offline-indicator');
            if (!navigator.onLine) {
                indicator.classList.add('show');
                showToast('warning', 'Offline Mode', 'You are viewing cached content');
            } else {
                indicator.classList.remove('show');
            }
        }

        function loadCachedData() {
            // Load cached videos from localStorage
            const cachedVideos = localStorage.getItem('gkStoreVideos');
            if (cachedVideos) {
                try {
                    appState.videos = JSON.parse(cachedVideos);
                } catch (e) {
                    console.log('Error parsing cached videos');
                }
            }
            
            const cachedAccounts = localStorage.getItem('gkStoreAccounts');
            if (cachedAccounts) {
                try {
                    appState.accounts = JSON.parse(cachedAccounts);
                } catch (e) {
                    console.log('Error parsing cached accounts');
                }
            }
            
            // Update UI with cached data
            loadHomeContent();
            loadAccountsContent();
        }

        async function checkDatabaseSetup() {
            if (!navigator.onLine || !supabase) return;
            
            try {
                const { error } = await supabase.from('videos').select('count').limit(1);
                if (error?.code === '42P01') showModal('sql-setup-modal');
            } catch { 
                // Silently fail offline
            }
        }

        function setupPWAInstall() {
            const isInstalled = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            if (isInstalled) return;
            
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                setTimeout(() => {
                    const btn = document.getElementById('pwa-install-btn');
                    if (btn) {
                        btn.classList.remove('hidden');
                        btn.onclick = () => {
                            deferredPrompt.prompt();
                            deferredPrompt.userChoice.then(() => deferredPrompt = null);
                        };
                    }
                }, 3000);
            });
        }

        function loadPreferences() {
            appState.language = localStorage.getItem('appLanguage') || 'en';
            appState.theme = localStorage.getItem('appTheme') || 'dark';
            document.documentElement.setAttribute('data-theme', appState.theme);
        }

        function setupEventListeners() {
            document.addEventListener('keydown', (e) => {
                if (appState.currentPage === 'home') {
                    if (e.key === 'ArrowUp') { e.preventDefault(); navigateVideo('prev'); }
                    if (e.key === 'ArrowDown') { e.preventDefault(); navigateVideo('next'); }
                }
            });

            let touchStartY = 0;
            const videoSection = document.getElementById('video-section');
            if (videoSection) {
                videoSection.addEventListener('touchstart', (e) => touchStartY = e.touches[0].clientY);
                videoSection.addEventListener('touchend', (e) => {
                    const diff = touchStartY - e.changedTouches[0].clientY;
                    if (Math.abs(diff) > 50 && !appState.isFullscreen) navigateVideo(diff > 0 ? 'next' : 'prev');
                });
            }

            window.addEventListener('online', () => {
                appState.isOnline = true;
                document.getElementById('offline-indicator').classList.remove('show');
                showToast('success', 'Back Online', 'Connection restored');
                // Try to recreate supabase client
                if (window.supabase) {
                    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                }
                // Sync data when back online
                syncData();
            });
            
            window.addEventListener('offline', () => {
                appState.isOnline = false;
                document.getElementById('offline-indicator').classList.add('show');
                showToast('warning', 'Offline', 'Using cached content');
            });
        }

        async function syncData() {
            if (!navigator.onLine || !supabase) return;
            await loadInitialData();
            showToast('success', 'Synced', 'Data synchronized');
        }

        async function loadInitialData() {
            if (!navigator.onLine || !supabase) return;
            
            try {
                await Promise.all([loadVideos(), loadAccounts(), loadBookRequests()]);
                updateNotificationCount();
                updateAdminStats();
            } catch (error) {
                console.error('Error loading initial data:', error);
                if (!appState.videos.length) {
                    initializeWithDemoData();
                }
            }
        }

        async function loadVideos() {
            if (!navigator.onLine || !supabase) return;
            
            const { data, error } = await supabase.from('videos').select('*').order('created_at', { ascending: false });
            if (error) {
                console.error('Error loading videos:', error);
                return;
            }
            if (data?.length) {
                appState.videos = data.map(v => ({
                    id: v.video_id, 
                    title: v.video_title, 
                    description: v.description, 
                    views: v.views || 0,
                    likes: v.likes || 0, 
                    url: v.video_url, 
                    tier: v.account_tier, 
                    price: v.price,
                    storage_path: v.storage_path,
                    bucket_name: v.bucket_name,
                    createdAt: v.created_at, 
                    account: { 
                        id: v.video_id, 
                        title: v.video_title, 
                        tier: v.account_tier, 
                        price: v.price,
                        url: v.video_url
                    }
                }));
                
                // Cache videos for offline use
                localStorage.setItem('gkStoreVideos', JSON.stringify(appState.videos));
            }
        }

        async function loadAccounts() {
            if (!navigator.onLine || !supabase) return;
            
            const { data, error } = await supabase.from('videos').select('video_id, video_title, description, account_tier, price, sold, video_url, storage_path, bucket_name');
            if (error) {
                console.error('Error loading accounts:', error);
                return;
            }
            if (data?.length) {
                appState.accounts = data.map(v => ({
                    id: v.video_id, 
                    title: v.video_title, 
                    description: v.description, 
                    tier: v.account_tier,
                    price: v.price, 
                    sold: v.sold || false, 
                    url: v.video_url,
                    storage_path: v.storage_path,
                    bucket_name: v.bucket_name
                }));
                
                // Cache accounts for offline use
                localStorage.setItem('gkStoreAccounts', JSON.stringify(appState.accounts));
            }
        }

        async function loadBookRequests() {
            if (!navigator.onLine || !supabase) return;
            
            const { data, error } = await supabase.from('book_requests').select('*').order('created_at', { ascending: false });
            if (error) {
                console.error('Error loading book requests:', error);
                return;
            }
            if (data) appState.bookRequests = data;
        }

        function initializeWithDemoData() {
            appState.videos = [{
                id: 'demo_001', title: 'Welcome to GK Store', description: 'Premium accounts marketplace',
                views: 150, likes: 45, url: 'https://assets.mixkit.co/videos/preview/mixkit-close-up-of-a-blue-tit-1257-large.mp4',
                tier: 'small', price: 199, account: { id: 'demo_001', title: 'Demo Account', tier: 'small', price: 199 }
            }];
            appState.accounts = [{
                id: 'demo_001', title: 'Demo Account', description: 'Premium demo account',
                tier: 'small', price: 199, sold: false,
                url: 'https://assets.mixkit.co/videos/preview/mixkit-close-up-of-a-blue-tit-1257-large.mp4'
            }];
            appState.notifications = [{
                id: 'notif_001', title: 'Welcome', message: 'Start exploring', icon: 'fas fa-play', time: 'Just now'
            }];
            
            // Cache demo data
            localStorage.setItem('gkStoreVideos', JSON.stringify(appState.videos));
            localStorage.setItem('gkStoreAccounts', JSON.stringify(appState.accounts));
        }

        function showPage(page) {
            if (['home','accounts','profile','contact','admin','notifications'].includes(page) && !appState.isLoggedIn) page = 'auth';
            if (page === 'auth' && appState.isLoggedIn) page = 'home';
            
            document.querySelectorAll('[id$="-page"]').forEach(p => p.classList.add('hidden'));
            document.getElementById(`${page}-page`).classList.remove('hidden');
            appState.currentPage = page;
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            const activeNav = document.querySelector(`.nav-item[href="#${page}"]`);
            if (activeNav) activeNav.classList.add('active');
            
            if (page === 'home') loadHomeContent();
            if (page === 'accounts') loadAccountsContent();
            if (page === 'admin') document.getElementById('admin-dashboard').classList.toggle('hidden', !appState.isAdminLoggedIn);
        }

        function loadHomeContent() {
            if (appState.videos.length) loadVideo(appState.currentVideoIndex);
            loadVideoGrid();
        }

        function loadVideo(index) {
            const video = appState.videos[index];
            if (!video) return;
            
            const section = document.getElementById('video-section');
            const placeholder = document.getElementById('video-placeholder');
            if (placeholder) placeholder.classList.add('hidden');
            
            section.innerHTML = '';
            
            const videoEl = document.createElement('video');
            videoEl.className = 'video-player';
            videoEl.controls = true;
            videoEl.playsInline = true;
            videoEl.src = video.url;
            videoEl.onloadeddata = () => appState.currentVideoPlayer = videoEl;
            videoEl.onended = () => {
                if (!appState.isFullscreen && index < appState.videos.length - 1) {
                    appState.currentVideoIndex++;
                    loadVideo(appState.currentVideoIndex);
                }
            };
            section.appendChild(videoEl);
            appState.currentAccount = video.account;
            createVideoOverlay(video, section);
        }

        function createVideoOverlay(video, container) {
            const overlay = document.createElement('div');
            overlay.className = 'video-overlay';
            overlay.innerHTML = `
                <div>
                    <h2 class="video-title">${video.title}</h2>
                    <p class="video-description">${video.description}</p>
                </div>
                <div class="video-top-actions">
                    <div class="flex flex-col items-center">
                        <button class="action-button" onclick="bookAccount()"><i class="fas fa-bookmark"></i></button>
                        <span class="action-label">Book</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <button class="action-button" onclick="buyNow()"><i class="fas fa-shopping-bag"></i></button>
                        <span class="action-label">Buy</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <button class="action-button" onclick="showShareModal('${video.id}')"><i class="fas fa-share"></i></button>
                        <span class="action-label">Share</span>
                    </div>
                </div>
            `;
            container.appendChild(overlay);
        }

        function loadVideoGrid() {
            const grid = document.getElementById('video-grid');
            grid.innerHTML = '';
            appState.videos.forEach((v, i) => {
                grid.innerHTML += `
                    <div class="video-item" onclick="playVideoFromGrid(${i})">
                        <div class="video-thumbnail flex items-center justify-center bg-gradient-to-br from-pink-500 to-purple-600" style="height: 100%;">
                            <i class="fas fa-play-circle text-3xl text-white"></i>
                        </div>
                        <button class="video-grid-share-btn" onclick="event.stopPropagation(); showShareModal('${v.id}')">
                            <i class="fas fa-share"></i>
                        </button>
                        <div class="video-item-overlay">
                            <div class="video-item-title">${v.title}</div>
                            <div class="video-item-stats">
                                <span><i class="fas fa-eye"></i> ${v.views}</span>
                                <span><i class="fas fa-heart"></i> ${v.likes}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function playVideoFromGrid(index) {
            appState.currentVideoIndex = index;
            showPage('home');
            loadVideo(index);
        }

        function playVideoFromAccount(id) {
            const video = appState.videos.find(v => v.id === id);
            if (video) {
                const index = appState.videos.findIndex(v => v.id === id);
                if (index !== -1) {
                    appState.currentVideoIndex = index;
                    showPage('home');
                    loadVideo(index);
                }
            }
        }

        function loadAccountsContent() {
            const grid = document.getElementById('accounts-grid');
            grid.innerHTML = '';
            if (!appState.accounts.length) {
                grid.innerHTML = '<div class="col-span-2 text-center py-12">No accounts available</div>';
                return;
            }
            appState.accounts.forEach(a => {
                grid.innerHTML += `
                    <div class="account-card">
                        <div class="account-icon ${a.tier}" onclick="playVideoFromAccount('${a.id}')">
                            <i class="fas ${a.tier === 'small' ? 'fa-user' : a.tier === 'medium' ? 'fa-user-tie' : 'fa-crown'}"></i>
                        </div>
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold">${a.title}</h3>
                            <span class="badge ${a.tier === 'big' ? 'badge-primary' : a.tier === 'medium' ? 'badge-secondary' : 'badge-warning'}">${a.tier}</span>
                        </div>
                        <p class="text-zinc-400 text-sm mb-4">${a.description || 'Premium account'}</p>
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-2xl font-bold gradient-text">$${a.price}</span>
                        </div>
                        <div class="account-actions">
                            <button class="account-action-btn book" onclick="bookFromAccount('${a.id}')">
                                <i class="fas fa-bookmark"></i> Book
                            </button>
                            <button class="account-action-btn buy" onclick="buyFromAccount('${a.id}')">
                                <i class="fas fa-shopping-bag"></i> Buy
                            </button>
                            <button class="account-action-btn share" onclick="shareFromAccount('${a.id}')">
                                <i class="fas fa-share"></i> Share
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function filterAccounts(tier) {
            document.querySelectorAll('#accounts-page .tab-item').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            const grid = document.getElementById('accounts-grid');
            const filtered = tier === 'all' ? appState.accounts : appState.accounts.filter(a => a.tier === tier);
            grid.innerHTML = '';
            filtered.forEach(a => {
                grid.innerHTML += `
                    <div class="account-card">
                        <div class="account-icon ${a.tier}" onclick="playVideoFromAccount('${a.id}')">
                            <i class="fas ${a.tier === 'small' ? 'fa-user' : a.tier === 'medium' ? 'fa-user-tie' : 'fa-crown'}"></i>
                        </div>
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold">${a.title}</h3>
                            <span class="badge ${a.tier === 'big' ? 'badge-primary' : a.tier === 'medium' ? 'badge-secondary' : 'badge-warning'}">${a.tier}</span>
                        </div>
                        <p class="text-zinc-400 text-sm mb-4">${a.description || 'Premium account'}</p>
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-2xl font-bold gradient-text">$${a.price}</span>
                        </div>
                        <div class="account-actions">
                            <button class="account-action-btn book" onclick="bookFromAccount('${a.id}')">
                                <i class="fas fa-bookmark"></i> Book
                            </button>
                            <button class="account-action-btn buy" onclick="buyFromAccount('${a.id}')">
                                <i class="fas fa-shopping-bag"></i> Buy
                            </button>
                            <button class="account-action-btn share" onclick="shareFromAccount('${a.id}')">
                                <i class="fas fa-share"></i> Share
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function bookFromAccount(id) {
            const account = appState.accounts.find(a => a.id === id);
            if (account) {
                appState.currentAccount = account;
                document.getElementById('book-account-name').textContent = account.title;
                document.getElementById('book-account-tier').textContent = account.tier;
                document.getElementById('book-account-price').textContent = `$${account.price}`;
                showModal('book-modal');
            }
        }

        function buyFromAccount(id) {
            const account = appState.accounts.find(a => a.id === id);
            if (account) {
                appState.currentAccount = account;
                document.getElementById('buy-account-name').textContent = account.title;
                document.getElementById('buy-account-tier').textContent = account.tier;
                document.getElementById('buy-account-price').textContent = `$${account.price}`;
                showModal('buy-modal');
            }
        }

        function shareFromAccount(id) {
            const account = appState.accounts.find(a => a.id === id);
            if (account) {
                appState.shareVideo = { id: account.id, title: account.title };
                document.getElementById('share-video-title').textContent = account.title;
                showModal('share-modal');
            }
        }

        function navigateVideo(dir) {
            if (dir === 'prev' && appState.currentVideoIndex > 0) loadVideo(--appState.currentVideoIndex);
            if (dir === 'next' && appState.currentVideoIndex < appState.videos.length - 1) loadVideo(++appState.currentVideoIndex);
        }

        async function adminLogin(e) {
            e.preventDefault();
            const email = document.getElementById('admin-email').value;
            const pass = document.getElementById('admin-password').value;
            
            if (!navigator.onLine || !supabase) {
                showToast('error', 'Offline', 'Cannot login while offline');
                return;
            }
            
            try {
                const { data, error } = await supabase.auth.signInWithPassword({ 
                    email, 
                    password: pass 
                });
                
                if (error) {
                    console.error('Login error:', error);
                    return showToast('error', 'Admin Login', 'Invalid credentials');
                }
                
                if (data.user) {
                    // Check if user has admin role in metadata
                    const userRole = data.user.user_metadata?.role || 
                                    data.user.raw_user_meta_data?.role;
                    
                    if (userRole === 'admin') {
                        appState.isAdminLoggedIn = true;
                        appState.isLoggedIn = true;
                        appState.currentUser = { 
                            email: data.user.email, 
                            name: 'Admin User', 
                            role: 'admin',
                            id: data.user.id
                        };
                        
                        localStorage.setItem('gkStoreUser', JSON.stringify(appState.currentUser));
                        localStorage.setItem('gkStoreAdmin', 'true');
                        localStorage.setItem('supabase.auth.token', data.session?.access_token);
                        
                        document.getElementById('admin-dashboard').classList.remove('hidden');
                        showToast('success', 'Admin Login', 'Logged in as admin');
                        showPage('admin');
                        updateAdminStats();
                    } else {
                        showToast('error', 'Admin Login', 'Not authorized as admin');
                        await supabase.auth.signOut();
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                showToast('error', 'Admin Login', 'Login failed');
            }
        }

        function updateAdminStats() {
            document.getElementById('admin-video-count').textContent = appState.videos.length;
            document.getElementById('admin-registered-users').textContent = appState.userStats.registeredUsers;
            document.getElementById('admin-online-users').textContent = appState.userStats.onlineUsers || 1;
            document.getElementById('admin-sold-count').textContent = appState.accounts.filter(a => a.sold).length;
            
            const activity = document.getElementById('admin-recent-activity');
            activity.innerHTML = '';
            appState.videos.slice(0, 3).forEach(v => {
                activity.innerHTML += `
                    <div class="flex items-center justify-between p-3 bg-surface-light rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
                                <i class="fas fa-video text-white text-xs"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium">${v.title}</p>
                                <p class="text-xs text-zinc-400">${v.tier} ‚Ä¢ $${v.price}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function showUploadVideo() {
            if (!appState.isAdminLoggedIn) {
                showToast('error', 'Access Denied', 'Login as admin first');
                return;
            }
            resetUploadForm();
            showModal('upload-video-modal');
        }

        function resetUploadForm() {
            document.getElementById('video-title-input').value = '';
            document.getElementById('video-description-input').value = '';
            document.getElementById('video-price').value = '';
            document.getElementById('video-tier').value = '';
            document.getElementById('video-file').value = '';
            document.getElementById('file-info').classList.add('hidden');
            document.getElementById('upload-status').classList.add('hidden');
            document.getElementById('upload-progress').style.width = '0%';
            document.getElementById('file-upload-area').classList.remove('has-file');
            document.getElementById('file-upload-text').textContent = 'Click to select video file';
            appState.currentUpload.file = null;
        }

        function updateBucketInfo() {
            const tier = document.getElementById('video-tier').value;
            const fileUploadArea = document.getElementById('file-upload-area');
            let maxSize = '500MB';
            
            if (tier === 'small') maxSize = '100MB';
            else if (tier === 'medium') maxSize = '200MB';
            
            const sizeText = fileUploadArea.querySelector('.text-xs');
            if (sizeText) {
                sizeText.textContent = `MP4, WebM, OGG (max ${maxSize})`;
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const tier = document.getElementById('video-tier').value;
            if (!tier) {
                showToast('error', 'Select Tier', 'Please select a tier first');
                document.getElementById('video-file').value = '';
                return;
            }
            
            // Check file size based on tier
            let maxSize = 500 * 1024 * 1024; // 500MB default for big
            if (tier === 'small') maxSize = 100 * 1024 * 1024;
            else if (tier === 'medium') maxSize = 200 * 1024 * 1024;
            
            if (file.size > maxSize) {
                const maxSizeMB = maxSize / (1024 * 1024);
                showToast('error', 'File Too Large', `Maximum size for ${tier} tier is ${maxSizeMB}MB`);
                document.getElementById('video-file').value = '';
                return;
            }
            
            // Check file type
            const validTypes = ['video/mp4', 'video/webm', 'video/ogg'];
            if (!validTypes.includes(file.type)) {
                showToast('error', 'Invalid Format', 'Please upload MP4, WebM, or OGG video');
                document.getElementById('video-file').value = '';
                return;
            }
            
            appState.currentUpload.file = file;
            
            // Update UI
            document.getElementById('file-info').classList.remove('hidden');
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-size').textContent = formatFileSize(file.size);
            document.getElementById('file-upload-area').classList.add('has-file');
            document.getElementById('file-upload-text').textContent = 'File selected';
            
            showToast('info', 'File Selected', file.name);
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function uploadVideo() {
            if (!appState.isAdminLoggedIn) {
                showToast('error', 'Access Denied', 'Please login as admin first');
                return;
            }
            
            if (!navigator.onLine || !supabase) {
                showToast('error', 'Offline', 'Cannot upload while offline');
                return;
            }
            
            // Get form values
            const title = document.getElementById('video-title-input').value;
            const description = document.getElementById('video-description-input').value || 'No description';
            const price = parseFloat(document.getElementById('video-price').value);
            const tier = document.getElementById('video-tier').value;
            const file = appState.currentUpload.file;
            
            // Validate inputs
            if (!title || !price || !tier || !file) {
                showToast('error', 'Validation Error', 'Please fill all fields and select a video');
                return;
            }
            
            // Generate unique video ID
            const videoId = `vid_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            // Determine bucket name
            const bucketName = `videos-${tier}`;
            const fileExt = file.name.split('.').pop();
            const fileName = `${videoId}.${fileExt}`;
            const filePath = `${fileName}`;
            
            // Show progress
            const statusDiv = document.getElementById('upload-status');
            const progressBar = document.getElementById('upload-progress');
            const progressText = document.getElementById('upload-percentage');
            const statusText = document.getElementById('upload-status-text');
            
            statusDiv.classList.remove('hidden');
            progressBar.style.width = '0%';
            progressText.textContent = '0%';
            statusText.textContent = 'Preparing upload...';
            
            const btn = document.getElementById('upload-btn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner animate-spin"></i> Uploading...';
            
            try {
                // Get current session
                const { data: { session } } = await supabase.auth.getSession();
                if (!session) {
                    throw new Error('No active session. Please login again.');
                }
                
                // Step 1: Upload file to Supabase Storage
                statusText.textContent = 'Uploading to storage...';
                
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from(bucketName)
                    .upload(filePath, file, {
                        cacheControl: '3600',
                        upsert: false
                    });
                
                if (uploadError) {
                    console.error('Storage upload error:', uploadError);
                    throw new Error(`Storage upload failed: ${uploadError.message}`);
                }
                
                statusText.textContent = 'Upload complete! Getting public URL...';
                
                // Step 2: Get public URL
                const { data: urlData } = supabase.storage
                    .from(bucketName)
                    .getPublicUrl(filePath);
                
                const publicUrl = urlData.publicUrl;
                
                statusText.textContent = 'Saving to database...';
                
                // Step 3: Insert video record into database
                const { data: insertData, error: insertError } = await supabase
                    .from('videos')
                    .insert([{
                        video_id: videoId,
                        video_title: title,
                        description: description,
                        video_url: publicUrl,
                        storage_path: filePath,
                        bucket_name: bucketName,
                        account_tier: tier,
                        price: price,
                        sold: false,
                        views: 0,
                        likes: 0
                    }])
                    .select();
                
                if (insertError) {
                    console.error('Database insert error:', insertError);
                    
                    // If database insert fails, try to clean up the uploaded file
                    await supabase.storage.from(bucketName).remove([filePath]);
                    
                    throw new Error(`Database insert failed: ${insertError.message}`);
                }
                
                statusText.textContent = 'Complete!';
                progressBar.style.width = '100%';
                progressText.textContent = '100%';
                
                // Add to local state
                const newVideo = insertData[0];
                appState.videos.unshift({
                    id: newVideo.video_id,
                    title: newVideo.video_title,
                    description: newVideo.description,
                    views: 0,
                    likes: 0,
                    url: newVideo.video_url,
                    tier: newVideo.account_tier,
                    price: newVideo.price,
                    storage_path: newVideo.storage_path,
                    bucket_name: newVideo.bucket_name,
                    account: {
                        id: newVideo.video_id,
                        title: newVideo.video_title,
                        tier: newVideo.account_tier,
                        price: newVideo.price,
                        url: newVideo.video_url
                    }
                });
                
                appState.accounts.unshift({
                    id: newVideo.video_id,
                    title: newVideo.video_title,
                    description: newVideo.description,
                    tier: newVideo.account_tier,
                    price: newVideo.price,
                    sold: false,
                    url: newVideo.video_url,
                    storage_path: newVideo.storage_path,
                    bucket_name: newVideo.bucket_name
                });
                
                // Update cache
                localStorage.setItem('gkStoreVideos', JSON.stringify(appState.videos));
                localStorage.setItem('gkStoreAccounts', JSON.stringify(appState.accounts));
                
                // Update UI
                loadHomeContent();
                updateAdminStats();
                
                showToast('success', 'Success!', `Video "${title}" uploaded successfully`);
                
                // Close modal after a short delay
                setTimeout(() => {
                    closeModal('upload-video-modal');
                    resetUploadForm();
                }, 1500);
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('error', 'Upload Failed', error.message);
                
                statusDiv.classList.add('hidden');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-upload"></i> Upload Video';
            }
        }

        async function showManageVideos() {
            if (!appState.isAdminLoggedIn) return showToast('error', 'Access Denied', 'Login as admin first');
            await loadAdminVideos();
            showModal('manage-videos-modal');
        }

        async function loadAdminVideos(filter = 'all') {
            const list = document.getElementById('admin-videos-list');
            const filtered = filter === 'all' ? appState.videos : appState.videos.filter(v => v.tier === filter);
            
            if (!filtered.length) {
                list.innerHTML = '<div class="text-center py-8 text-zinc-400">No videos found</div>';
                return;
            }
            
            list.innerHTML = '';
            filtered.forEach(v => {
                list.innerHTML += `
                    <div class="flex items-center justify-between p-3 bg-surface-light rounded-lg">
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <span class="font-medium">${v.title}</span>
                                <span class="badge ${v.tier === 'big' ? 'badge-primary' : v.tier === 'medium' ? 'badge-secondary' : 'badge-warning'}">${v.tier}</span>
                            </div>
                            <p class="text-xs text-zinc-400">ID: ${v.id} ‚Ä¢ $${v.price}</p>
                        </div>
                        <div class="flex gap-2">
                            <button class="btn btn-sm btn-danger" onclick="deleteVideo('${v.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function adminFilterVideos(tier) {
            document.querySelectorAll('#manage-videos-modal .tab-item').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            loadAdminVideos(tier);
        }

        async function deleteVideo(id) {
            if (!appState.isAdminLoggedIn || !confirm('Delete this video?')) return;
            
            if (!navigator.onLine || !supabase) {
                showToast('error', 'Offline', 'Cannot delete while offline');
                return;
            }
            
            const video = appState.videos.find(v => v.id === id);
            
            try {
                // Delete from storage if exists
                if (video?.storage_path && video?.bucket_name) {
                    await supabase.storage
                        .from(video.bucket_name)
                        .remove([video.storage_path]);
                }
                
                // Delete from database
                const { error } = await supabase
                    .from('videos')
                    .delete()
                    .eq('video_id', id);
                
                if (error) throw error;
                
                // Update local state
                appState.videos = appState.videos.filter(v => v.id !== id);
                appState.accounts = appState.accounts.filter(a => a.id !== id);
                
                // Update cache
                localStorage.setItem('gkStoreVideos', JSON.stringify(appState.videos));
                localStorage.setItem('gkStoreAccounts', JSON.stringify(appState.accounts));
                
                loadAdminVideos('all');
                updateAdminStats();
                showToast('success', 'Video Deleted', 'Removed successfully');
                
            } catch (error) {
                console.error('Delete error:', error);
                showToast('error', 'Delete Failed', error.message);
            }
        }

        async function showBookRequests() {
            if (!appState.isAdminLoggedIn) return showToast('error', 'Access Denied', 'Login as admin first');
            await loadAdminBookRequests();
            showModal('book-requests-modal');
        }

        async function loadAdminBookRequests() {
            if (!navigator.onLine || !supabase) {
                document.getElementById('admin-book-requests-list').innerHTML = '<div class="text-center py-8 text-zinc-400">Offline - Cannot load requests</div>';
                return;
            }
            
            const list = document.getElementById('admin-book-requests-list');
            const empty = document.getElementById('admin-book-requests-empty');
            await loadBookRequests();
            
            if (appState.bookRequests.length) {
                list.classList.remove('hidden');
                empty.classList.add('hidden');
                list.innerHTML = '';
                appState.bookRequests.forEach(r => {
                    list.innerHTML += `
                        <div class="card bg-surface-light">
                            <div class="card-body">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-semibold">${r.user_name}</h4>
                                    <span class="text-xs text-zinc-400">${new Date(r.created_at).toLocaleDateString()}</span>
                                </div>
                                <p class="text-sm mb-2">${r.whatsapp_number}</p>
                                <div class="flex gap-2 mt-3">
                                    <button class="btn btn-sm btn-primary flex-1" onclick="contactRequester('${r.whatsapp_number}')">
                                        <i class="fab fa-whatsapp"></i> Contact
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            } else {
                list.classList.add('hidden');
                empty.classList.remove('hidden');
            }
        }

        function contactRequester(number) {
            window.open(`https://wa.me/${number.replace(/\D/g,'')}?text=${encodeURIComponent('Hello from GK Store')}`, '_blank');
        }

        function bookAccount() {
            if (!appState.currentAccount) return;
            document.getElementById('book-account-name').textContent = appState.currentAccount.title;
            document.getElementById('book-account-tier').textContent = appState.currentAccount.tier;
            document.getElementById('book-account-price').textContent = `$${appState.currentAccount.price}`;
            showModal('book-modal');
        }

        function buyNow() {
            if (!appState.currentAccount) return;
            document.getElementById('buy-account-name').textContent = appState.currentAccount.title;
            document.getElementById('buy-account-tier').textContent = appState.currentAccount.tier;
            document.getElementById('buy-account-price').textContent = `$${appState.currentAccount.price}`;
            showModal('buy-modal');
        }

        async function submitBookRequest() {
            const name = document.getElementById('book-name').value;
            const whatsapp = document.getElementById('book-whatsapp').value;
            if (!name || !whatsapp || !appState.currentAccount) return showToast('error', 'Validation Error', 'Fill all fields');
            
            if (!navigator.onLine || !supabase) {
                showToast('error', 'Offline', 'Cannot submit while offline');
                return;
            }
            
            const { error } = await supabase.from('book_requests').insert([{
                video_id: appState.currentAccount.id, 
                user_name: name, 
                whatsapp_number: whatsapp
            }]);
            
            if (error) {
                console.error('Book request error:', error);
                showToast('error', 'Submission Failed', error.message);
            } else {
                showToast('success', 'Request Submitted', 'We will contact you');
                closeModal('book-modal');
                document.getElementById('book-name').value = '';
                document.getElementById('book-whatsapp').value = '';
            }
        }

        function showShareModal(id) {
            appState.shareVideo = appState.videos.find(v => v.id === id) || 
                                 { id, title: 'Share Video' };
            document.getElementById('share-video-title').textContent = appState.shareVideo?.title || 'Video';
            showModal('share-modal');
        }

        function shareViaWhatsApp() {
            if (!appState.shareVideo) return;
            window.open(`https://wa.me/?text=${encodeURIComponent(`Check out this video: ${appState.shareVideo.title} - ${window.location.href}`)}`, '_blank');
        }

        function shareViaTelegram() {
            if (!appState.shareVideo) return;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(appState.shareVideo.title)}`, '_blank');
        }

        function copyShareLink() {
            navigator.clipboard.writeText(window.location.href);
            showToast('success', 'Copied', 'Link copied');
        }

        function shareViaSystem() {
            if (navigator.share && appState.shareVideo) {
                navigator.share({ 
                    title: appState.shareVideo.title, 
                    url: window.location.href 
                });
            } else {
                copyShareLink();
            }
        }

        function copyUSDTAddress() {
            navigator.clipboard.writeText(document.getElementById('usdt-address').textContent);
            showToast('success', 'Copied', 'Address copied');
        }

        function copyAddress() {
            navigator.clipboard.writeText(document.getElementById('payment-address').textContent);
            showToast('success', 'Copied', 'Address copied');
        }

        function openWhatsApp() {
            window.open('https://wa.me/93793066322?text=Hello%20GK%20Store', '_blank');
        }

        function openPaymentChat() {
            if (!appState.currentAccount) return;
            window.open(`https://wa.me/93793066322?text=${encodeURIComponent(`I want to buy: ${appState.currentAccount.title} for $${appState.currentAccount.price}`)}`, '_blank');
        }

        function showLoginForm() {
            document.getElementById('login-form-container').classList.remove('hidden');
            document.getElementById('signup-form-container').classList.add('hidden');
            document.getElementById('forgot-password-container').classList.add('hidden');
        }

        function showSignupForm() {
            document.getElementById('login-form-container').classList.add('hidden');
            document.getElementById('signup-form-container').classList.remove('hidden');
            document.getElementById('forgot-password-container').classList.add('hidden');
        }

        function showForgotPassword() {
            document.getElementById('login-form-container').classList.add('hidden');
            document.getElementById('signup-form-container').classList.add('hidden');
            document.getElementById('forgot-password-container').classList.remove('hidden');
        }

        function login(e) {
            e.preventDefault();
            appState.currentUser = { 
                email: document.getElementById('login-email').value, 
                name: 'User' 
            };
            appState.isLoggedIn = true;
            if (document.getElementById('remember-me').checked) {
                localStorage.setItem('gkStoreUser', JSON.stringify(appState.currentUser));
            }
            showToast('success', 'Welcome', 'Login successful');
            showPage('home');
        }

        function signup(e) {
            e.preventDefault();
            const pass = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm-password').value;
            if (pass !== confirm) return showToast('error', 'Signup Failed', 'Passwords do not match');
            if (pass.length < 6) return showToast('error', 'Signup Failed', 'Password too short');
            
            appState.currentUser = { 
                name: document.getElementById('signup-name').value, 
                email: document.getElementById('signup-email').value 
            };
            appState.isLoggedIn = true;
            localStorage.setItem('gkStoreUser', JSON.stringify(appState.currentUser));
            showToast('success', 'Welcome', 'Account created');
            showPage('home');
        }

        function resetPassword(e) {
            e.preventDefault();
            showToast('success', 'Reset Link Sent', 'Check your email');
            showLoginForm();
        }

        async function logout() {
            if (navigator.onLine && supabase) {
                await supabase.auth.signOut();
            }
            appState.isLoggedIn = false;
            appState.currentUser = null;
            appState.isAdminLoggedIn = false;
            localStorage.removeItem('gkStoreUser');
            localStorage.removeItem('gkStoreAdmin');
            localStorage.removeItem('supabase.auth.token');
            showPage('auth');
        }

        function toggleLanguage() { showModal('language-modal'); }

        function setLanguage(lang) {
            appState.language = lang;
            localStorage.setItem('appLanguage', lang);
            document.querySelectorAll('[id^="lang-"]').forEach(c => c.classList.add('hidden'));
            document.getElementById(`lang-${lang}-check`).classList.remove('hidden');
            document.body.dir = ['ar','fa','ur','ps'].includes(lang) ? 'rtl' : 'ltr';
            closeModal('language-modal');
        }

        function toggleTheme() {
            appState.theme = appState.theme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('appTheme', appState.theme);
            document.documentElement.setAttribute('data-theme', appState.theme);
        }

        function showModal(id) {
            document.getElementById(id).classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
            document.body.style.overflow = '';
        }

        function closeWelcomeModal() {
            closeModal('welcome-modal');
            showPage('auth');
        }

        function showToast(type, title, msg) {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toast-icon');
            icon.className = `fas ${
                type === 'success' ? 'fa-check-circle text-success' : 
                type === 'error' ? 'fa-exclamation-circle text-danger' : 
                type === 'warning' ? 'fa-exclamation-triangle text-warning' :
                'fa-info-circle text-primary'
            }`;
            document.getElementById('toast-title').textContent = title;
            document.getElementById('toast-message').textContent = msg;
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        }

        function updateNotificationCount() {
            const unread = appState.notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notification-count');
            badge.classList.toggle('hidden', !unread);
            badge.textContent = unread;
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
